<html>
    <head>
        <title>chat using socket.io</title>
        <link rel="stylesheet" href="jennchat.css">
    </head>
    <body>
        <div class="container">
        <h1>Jenn Chat!</h1>
        <form id="form">
            <input id ="myname" placeholder="name" autocomplete="off" />
            <input id="message" placeholder="message" autocomplete="off" />
            <button>Send</button>
        </form>
        <div id = "messageArea"></div>
        <script src="/socket.io/socket.io.js"></script>
        <script>
            let socket = io();
            let form = document.getElementById("form");
            let myname = document.getElementById("myname");
            let message = document.getElementById("message");
            let messageArea =document.getElementById("messageArea");

            form.addEventListener("submit", (e) => {
                e.preventDefault();
                if (!myname.value.trim()) {
                    alert("Please enter your name first!");
                    return;
                }
                if (message.value.trim()) {
                    socket.emit("send message", {
                        name: myname.value,
                        text: message.value
                    });
                    message.value = "";
                }
            });
            socket.on("send message", data => {
                let wrapper = document.createElement("div");
                wrapper.style.marginBottom = "10px";

                let name = document.createElement("p");
                name.textContent = data.name + ":";

                let chatContent = document.createElement("p");
                chatContent.textContent = data.text;

                wrapper.appendChild(name);
                wrapper.appendChild(chatContent);
                messageArea.appendChild(wrapper);
                window.scrollTo(0,document.body.scrollHeight);
            });
        </script>
        </div>
    </body>
</html>
